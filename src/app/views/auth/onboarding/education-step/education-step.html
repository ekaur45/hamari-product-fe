<p-toast />
<p-confirmDialog />
<div class="min-h-screen-minus-header bg-gray-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-lg p-8 w-full max-w-5xl space-y-10">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-graduation-cap text-primary text-3xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-900 mb-2">Education</h2>
            <p class="text-gray-600">Add your educational background and qualifications</p>
        </div>

        <!-- Add Education Form -->
        <div class="space-y-6">
            <div class="pb-2 border-b border-gray-100">
                <h4 class="text-2xl font-bold text-gray-900 mb-2 flex items-center gap-3">
                    <div class="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center">
                        <i class="fas fa-plus-circle text-primary text-lg"></i>
                    </div>
                    <span>{{ educationForm.get('id')?.value ? 'Edit Education' : 'Add Education' }}</span>
                </h4>
                <p class="text-sm text-gray-600 mt-2 ml-13">Enter your educational qualifications and achievements</p>
            </div>

            <form [formGroup]="educationForm" (ngSubmit)="onSubmit()" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Institute Name -->
                    <div class="space-y-2">
                        <label class="block text-sm font-semibold text-gray-800 mb-2">
                            <i class="fas fa-university mr-2 text-primary"></i>
                            Institute Name
                            <span class="text-red-500 ml-1">*</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-university text-gray-400"></i>
                            </div>
                            <input type="text"
                                formControlName="instituteName"
                                placeholder="e.g., Harvard University"
                                class="w-full pl-11 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition bg-gray-50/50"
                                [class.border-red-300]="educationForm.get('instituteName')?.invalid && educationForm.get('instituteName')?.touched"
                                [class.border-gray-300]="!(educationForm.get('instituteName')?.invalid && educationForm.get('instituteName')?.touched)">
                        </div>
                        @if (educationForm.get('instituteName')?.invalid && educationForm.get('instituteName')?.touched) {
                            <p class="text-red-500 text-xs mt-1">Institute name is required</p>
                        }
                    </div>

                    <!-- Degree Name -->
                    <div class="space-y-2">
                        <label class="block text-sm font-semibold text-gray-800 mb-2">
                            <i class="fas fa-graduation-cap mr-2 text-primary"></i>
                            Degree Name
                            <span class="text-red-500 ml-1">*</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-graduation-cap text-gray-400"></i>
                            </div>
                            <input type="text"
                                formControlName="degreeName"
                                placeholder="e.g., Bachelor of Science"
                                class="w-full pl-11 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition bg-gray-50/50"
                                [class.border-red-300]="educationForm.get('degreeName')?.invalid && educationForm.get('degreeName')?.touched"
                                [class.border-gray-300]="!(educationForm.get('degreeName')?.invalid && educationForm.get('degreeName')?.touched)">
                        </div>
                        @if (educationForm.get('degreeName')?.invalid && educationForm.get('degreeName')?.touched) {
                            <p class="text-red-500 text-xs mt-1">Degree name is required</p>
                        }
                    </div>

                    <!-- Started Year -->
                    <div class="space-y-2">
                        <label class="block text-sm font-semibold text-gray-800 mb-2">
                            <i class="fas fa-calendar mr-2 text-primary"></i>
                            Started Year
                            <span class="text-red-500 ml-1">*</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-calendar text-gray-400"></i>
                            </div>
                            <input type="number"
                                formControlName="startedYear"
                                placeholder="e.g., 2018"
                                min="1950"
                                max="2030"
                                class="w-full pl-11 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition bg-gray-50/50"
                                [class.border-red-300]="educationForm.get('startedYear')?.invalid && educationForm.get('startedYear')?.touched"
                                [class.border-gray-300]="!(educationForm.get('startedYear')?.invalid && educationForm.get('startedYear')?.touched)">
                        </div>
                        @if (educationForm.get('startedYear')?.invalid && educationForm.get('startedYear')?.touched) {
                            <p class="text-red-500 text-xs mt-1">Started year is required</p>
                        }
                    </div>

                    <!-- Ended Year -->
                    <div class="space-y-2">
                        <label class="block text-sm font-semibold text-gray-800 mb-2">
                            <i class="fas fa-calendar-check mr-2 text-primary"></i>
                            Ended Year
                            @if (!getFormValue('isStillStudying')) {
                                <span class="text-red-500 ml-1">*</span>
                            }
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-calendar-check text-gray-400"></i>
                            </div>
                            <input type="number"
                                formControlName="endedYear"
                                placeholder="e.g., 2022"
                                min="1950"
                                max="2030"
                                [disabled]="getFormValue('isStillStudying')"
                                class="w-full pl-11 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition bg-gray-50/50 disabled:opacity-50 disabled:cursor-not-allowed"
                                [class.border-red-300]="educationForm.get('endedYear')?.invalid && educationForm.get('endedYear')?.touched && !getFormValue('isStillStudying')"
                                [class.border-gray-300]="!(educationForm.get('endedYear')?.invalid && educationForm.get('endedYear')?.touched && !getFormValue('isStillStudying'))">
                        </div>
                        @if (educationForm.get('endedYear')?.invalid && educationForm.get('endedYear')?.touched && !getFormValue('isStillStudying')) {
                            <p class="text-red-500 text-xs mt-1">Ended year is required</p>
                        }
                        <label class="flex items-center mt-2 cursor-pointer">
                            <p-toggleSwitch formControlName="isStillStudying" />
                            <span class="ml-2 text-sm text-gray-600">
                                <i class="fas fa-clock mr-1"></i>
                                Still studying
                            </span>
                        </label>
                    </div>

                    <!-- Remarks -->
                    <div class="md:col-span-2 space-y-2">
                        <label class="block text-sm font-semibold text-gray-800 mb-2">
                            <i class="fas fa-comment mr-2 text-primary"></i>
                            Remarks
                        </label>
                        <div class="relative">
                            <textarea rows="3"
                                formControlName="remarks"
                                placeholder="Optional remarks about your education, achievements, or specializations..."
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition resize-none bg-gray-50/50"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Add/Update Button -->
                <div class="flex justify-end pt-4 border-t border-gray-200">
                    <button type="submit"
                        [disabled]="isSaving()"
                        class="px-8 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 transition-all duration-200 shadow-md hover:shadow-lg text-white bg-primary hover:bg-primary/90 active:scale-95 min-w-[160px] disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="fas" [ngClass]="{'fa-spinner fa-spin': isSaving(), 'fa-plus-circle': !isSaving() && !educationForm.get('id')?.value, 'fa-save': !isSaving() && educationForm.get('id')?.value}"></i>
                        <span>
                            @if (isSaving()) {
                                Saving...
                            } @else if (educationForm.get('id')?.value) {
                                Update Education
                            } @else {
                                Add Education
                            }
                        </span>
                    </button>
                </div>
            </form>
        </div>

        <!-- Divider -->
        <div class="border-t border-gray-200"></div>

        <!-- Education List -->
        <div class="space-y-6">
            <div class="pb-2 border-b border-gray-100">
                <h4 class="text-2xl font-bold text-gray-900 mb-2 flex items-center gap-3">
                    <div class="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center">
                        <i class="fas fa-list text-primary text-lg"></i>
                    </div>
                    <span>Your Education</span>
                </h4>
                <p class="text-sm text-gray-600 mt-2 ml-13">Manage your educational qualifications</p>
            </div>

            <!-- Education Cards Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                @for (education of educations(); track education.id) {
                    <div class="bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200 overflow-hidden">
                        <!-- Card Header -->
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                                    <i class="fas fa-graduation-cap text-primary text-xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h3 class="text-lg font-semibold text-gray-900 truncate">{{ education.degreeName }}</h3>
                                    <div class="flex items-center gap-2 mt-1">
                                        <i class="fas fa-university text-gray-400 text-sm"></i>
                                        <span class="text-sm text-gray-600 truncate">{{ education.instituteName }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Card Body -->
                        <div class="p-6">
                            <!-- Date Range -->
                            <div class="flex items-center gap-2 text-sm text-gray-700 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200 mb-4">
                                <i class="fas fa-calendar text-gray-400"></i>
                                <span class="font-medium">
                                    {{ education.startedYear }} - {{ education.isStillStudying ? 'Present' : (education.endedYear || 'N/A') }}
                                </span>
                                @if (education.isStillStudying) {
                                    <span class="ml-2 px-2 py-0.5 bg-green-100 text-green-700 rounded text-xs font-medium">
                                        Ongoing
                                    </span>
                                }
                            </div>

                            <!-- Remarks -->
                            @if (education.remarks) {
                                <div class="mb-4">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-comment text-gray-400 mt-1 text-sm"></i>
                                        <p class="text-sm text-gray-700 leading-relaxed">{{ education.remarks }}</p>
                                    </div>
                                </div>
                            }

                            <!-- Card Actions -->
                            <div class="flex items-center justify-end gap-2 pt-4 border-t border-gray-100">
                                <button type="button"
                                    (click)="onEdit(education)"
                                    class="px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition flex items-center justify-center gap-2">
                                    <i class="fas fa-edit"></i>
                                    <span>Edit</span>
                                </button>
                                <button type="button"
                                    (click)="onEducationDeleteConfirm(education)"
                                    class="px-4 py-2 text-sm bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition flex items-center justify-center gap-2">
                                    <i class="fas fa-trash"></i>
                                    <span>Delete</span>
                                </button>
                            </div>
                        </div>
                    </div>
                } @empty {
                    <div class="md:col-span-2 bg-white rounded-lg border border-gray-200 border-dashed p-12 text-center">
                        <i class="fas fa-graduation-cap text-gray-300 text-4xl mb-4"></i>
                        <p class="text-gray-500 text-lg font-medium mb-2">No education records yet</p>
                        <p class="text-gray-400 text-sm">Add your educational background to get started</p>
                    </div>
                }
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-end pt-6 border-t border-gray-200">
            <button type="button"
                (click)="onContinue()"
                class="px-8 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 transition-all duration-200 shadow-md hover:shadow-lg text-white bg-primary hover:bg-primary/90 active:scale-95 min-w-[160px]">
                <i class="fas fa-arrow-right"></i>
                <span>Continue</span>
            </button>
        </div>
    </div>
</div>

